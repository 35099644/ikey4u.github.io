<html>
<head>
     <title>乌云爆告之双十一电商的安全警示 - 佳佳佳佳佳</title>
	 <meta http-equiv="content-type" content="text/html; charset=UTF-8">
</head>
<body>
<h1>URL:<a href="http://drops.wooyun.org/papers/10409">http://drops.wooyun.org/papers/10409</a></h1>

      <p>
        <h1>Chapter One 前言</h1>

<hr />

<p>随着十一月的到来，一年一度的电商狂欢节——双十一就这样没有一点点防备地降临了。不知道什么时候，双十一和光棍节的关系越来越远，变成了剁手党的节日。</p>

<p>电商是什么时候开始走入大众的生活呢？</p>

<p>1990至1993年的电子数据交换时代是中国电子商务的起步期，直到1998年开始，互联网电子商务才开始进入发展阶段；1998年3月，中国第一笔互联网网上交易成功；1999年阿里巴巴成立。现在中国电商已走入第25个年头，形成了一套集交易、物流、拍卖、支付为一体，具备<code>B2B</code>、<code>B2C</code>、<code>C2C</code>等多种模式，用户众多的产业生态链。电商带起的网络购物正在成为民众的主要购物通道之一。</p>

<p>然而在这样一片大好的形式之下，会不会有着我们看不到的波涛正在暗涌呢？当购物行为和互联网相结合，会带来怎样的安全风险呢？电商正在面临着哪些安全风险挑战呢？</p>

<p>目前知名的电商平台有<a href="http://www.wooyun.org/corps/%E9%98%BF%E9%87%8C%E5%B7%B4%E5%B7%B4">阿里巴巴</a>以及旗下的<a href="http://www.wooyun.org/corps/%E6%B7%98%E5%AE%9D%E7%BD%91">淘宝网</a>、<a href="http://www.wooyun.org/corps/%E4%BA%AC%E4%B8%9C%E5%95%86%E5%9F%8E">京东商城</a>、<a href="http://www.wooyun.org/corps/%E6%B1%9F%E8%8B%8F%E8%8B%8F%E5%AE%81%E6%98%93%E8%B4%AD%E7%94%B5%E5%AD%90%E5%95%86%E5%8A%A1%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8">苏宁易购</a>、<a href="http://www.wooyun.org/corps/%E5%94%AF%E5%93%81%E4%BC%9A">唯品会</a>、<a href="http://www.wooyun.org/corps/%E8%98%91%E8%8F%87%E8%A1%97">蘑菇街</a>、<a href="http://www.wooyun.org/corps/%E7%BE%8E%E4%B8%BD%E8%AF%B4">美丽说</a>、<a href="http://www.wooyun.org/corps/%E5%9B%BD%E7%BE%8E%E6%8E%A7%E8%82%A1%E9%9B%86%E5%9B%A2">国美</a>、<a href="http://www.wooyun.org/corps/%E5%BD%93%E5%BD%93%E7%BD%91">当当网</a>和<a href="http://www.wooyun.org/corps/%E8%81%9A%E7%BE%8E%E4%BC%98%E5%93%81">聚美优品</a>等，据不完全统计，乌云平台自成立以来，已收集到的电商平台漏洞总数达<code>1169</code>个，其中<code>2015</code>年电商平台漏洞数为<code>414</code>个，相比于<code>2014</code>年，漏洞总数上涨了<code>68.98%</code>。</p>

<p>然而这些也只是电商平台目前存在的安全问题的冰山一角。在这个网购为王、线上支付成为主流支付方式的时代，电商平台掌握着海量用户的信息和资金，这使得厂商在安全上承担的责任随之变大。然而要保护用户的信息和资金安全又谈何容易？厂商在应对互联网带来的网络安全威胁以外，还需要同时兼顾内部人员管理，做到安全管理的全面覆盖。</p>

<!--more-->

<p>2015年10月28日，某微信公众号发出一篇名为<code>《“他们自称是天猫客服…”杭州近万条买家信息外流！近期网购要留心！》</code>的文章。文章披露了某个在一家为天猫某品牌旗舰店做销售的公司工作的小伙子，通过工作便利，出售用户信息。用户信息的外流导致许多买家接到自称为天猫客服的诈骗电话，并有多人受骗。这名小伙子在短短一个星期的时间内，先后出售了<code>9000</code>余条买家信息，牟利<code>45800</code>元。</p>

<p>这样的事件让人不禁感叹，电商处处有诱惑。在普通人眼里看起来并不重要的信息，到了黑产或者骗子手中，就成为了价值连城的东西。通过这样的事件，你是否也想起了这样的曾经：刚买了房，就能接到各种装修电话；刚有了小孩，就有人在推销保险、奶粉；刚下完订单，就有客服电话你说订单信息有问题....这些曾经让你百思不得其解的事情，此刻突然变得明朗，现在你也就明白了，为什么你的需求总是如此精准地被对方获知。</p>

<p>小编通过明察暗访以及长期的潜伏，也收集到很多围绕电商这个行业展开的非法牟利活动的证据。</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/5309757827f5bce49358dca7463492a5.jpg" alt="enter image description here" /></p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/9def140a2980b917750599cf774a6e86.jpg" alt="enter image description here" /></p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/df866fd24a506502f5f0ed265e78fcbd.jpg" alt="enter image description here" /></p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/36bcab233f6b488c2306f6c2f6557293.jpg" alt="enter image description here" /></p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/e4475777204468ca62938d0858bcb0d2.jpg" alt="enter image description here" /></p>

<p>这些光明正大的求购信息让人不禁对电商购物产生了怀疑——网络购物在给我们的生活带来便利的同时，似乎还带来了很多负面的危害，用户信息就这样赤裸裸地成为了黑产交易的对象。</p>

<p>第二期的<code>乌云爆告</code>在双十一来临之际，与您一起解读电商购物面临的安全风险，希望能给厂商带来警示，安全无小事，用户权益更需要厂商的全面保护。</p>

<h1>Chapter Two 购物风险知多少</h1>

<hr />

<p>和上一期的<code>乌云爆告</code>一样，我们将用真实案例来带大家认识电商平台的安全痛点以及网络购物潜藏的安全风险。选取的案例来自乌云平台，其中写了细节的案例均为平台上已通知厂商进行修复并公开的漏洞和乌云社区的公开帖子，未公开的漏洞将在文中以预警方式出现。</p>

<h3>眼见不一定为实</h3>

<p><strong>WooYun-2015-144614</strong></p>

<p><strong><a href="http://www.wooyun.org/bugs/wooyun-2015-0144614">淘宝4945/2345582等超权限模块漏洞可修改信誉、销量欺骗消费者</a></strong></p>

<p>在淘宝店铺中添加模块id为：<code>4945</code>，<code>2345582</code>等超权限模块后在该模块内写入<code>css</code>可成功<code>修改店铺信誉等级</code>、<code>屏蔽中差评</code>、<code>修改店铺动态评分</code>，严重欺骗消费者！</p>

<p>测试过程：</p>

<p>测试店铺未修改前是两个红心</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/8a40aceb47b5b8fb2556a0d51fe042f6.jpg" alt="enter image description here" /></p>

<p>进入测试店铺后台，编辑4945模块，加入css样式后保存并发布。</p>

<p>其中，将红心修改成金冠代码：</p>

<pre><code>&lt;style&gt;

/*页头信誉修改成金冠*/

.tshop-psm-shop-header2 .tb-rank-red i{background-position: -60px 0;}

&lt;/style&gt;
</code></pre>

<p>测试结果：</p>

<p>发布后原测试店铺已经显示2个金冠了</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/60b857d374e82680d1f6161617f2c025.jpg" alt="enter image description here" /></p>

<p><strong>小编说</strong>：在淘宝购物时，店铺的信誉等级、用户评价等信息，本来是作为消费者消费前对店铺进行评判的一个标准。小编我在网购时也习惯选择信誉等级较高、用户好评多的店铺，然而有一天，如果你突然发现这个信誉等级其实可以通过技术手段随意修改，你还会相信你看到的么？虽然厂商回复说仅有特定用户才可以使用这个模块，但对于并不知道什么样的特定用户可以使用这个模块的我们来说，并没有被保障到的感觉。</p>

<p><strong>WooYun-2015-115947</strong></p>

<p><strong><a href="http://www.wooyun.org/bugs/wooyun-2015-0115947">淘宝客户端某漏洞导致可以大规模钓鱼获取淘宝账号</a></strong></p>

<p>淘宝客户端某漏洞导致可以大规模钓鱼获取淘宝账号。</p>

<p>淘宝客户端的基础协议是<code>taobao://</code>，由于淘宝客户端的设计缺陷，导致可以在后面加<code>URL</code>打开任意网站。</p>

<p>虽然<code>APP</code>做了正则匹配，对于不在白名单中的<code>URL</code>，会跳出提示，例如</p>

<pre><code>taobao://wooyun.org
</code></pre>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/c4f5222354e2b3fb21744799e318de9f.jpg" width = "300" height = "533" alt="图片名称" align=center /></p>

<p>但是很不幸，一番尝试之后，发现利用<code>taobao://**-taobao.com</code>这样的格式，并且“<code>**</code>”为某个域名后缀就可以绕过该限制，“<code>**</code>”为其他英文字符的则无法绕过限制。</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/c6fcf11fdb5727b7c6e6af487b560a2d.jpg" width = "300" height = "533" alt="图片名称" align=center /></p>

<p>绕过之后你可以做什么呢？</p>

<p>比如注册一个<code>org-taobao.com</code>，做一个高仿的手机淘宝网登录页面放在上面就可以开始安心钓鱼了。</p>

<p>打开页面后，输入用户名密码，点击登陆，用户名密码自动记录到数据库。</p>

<p>甚至可以在点击后提示：您的淘宝账号存在风险请申诉之类的，然后要求填各种信息。</p>

<p>可能有人会问：谁会没事去点一个伪协议链接呢？这是一个非常好解决的问题，你只需要把跳转代码放在其他站点中，或者发在微博上，就不怕别人不点了。</p>

<p>为此白帽子还做了一个视频演示，可以更直观地看到漏洞。</p>

<p><embed src="http://player.youku.com/player.php/sid/XOTYzMzYyNTQw/v.swf" allowFullScreen="true" quality="high" width="480" height="400" align="middle" allowScriptAccess="always" type="application/x-shockwave-flash">
</embed></p>

<p><strong>小编说</strong>：眼见有时也不是真的，身边的小伙伴也经历过各种各样的钓鱼，这样的钓鱼网站总是让一些白傻甜来不及防备，厂商在接受用户带来的巨大利润同时，也应完成保护用户数据安全的职责。</p>

<p><strong>WooYun-2015-113117</strong></p>

<p><strong><a href="http://www.wooyun.org/bugs/wooyun-2015-0113117">利用京东URL跳转漏洞进行的邮件钓鱼事件（已经有AppleID钓鱼邮件出现）</a></strong></p>

<p>白帽子测试代码如下</p>

<p>利用京东URL跳转漏洞，可以跳转至白帽子做的钓鱼网站进行钓鱼。</p>

<pre><code>http://ccc.x.jd.com/dsp/nc?ext=dC54ZHR6c3lzYS5vcmcuY24vP3VuaW9uSWQ9NTIwMDYmc2l0ZWlkPTMwMTEyMzdfNDUmdG89aHR0cDovL2l0ZW0uamQuY29tLzE0NzM3MjgyMzEuaHRtbA==&amp;log=OQ8OrrVeLMzoBfpHKbrsj4P1+JaRXF/bTebKX43d+U/e1Zk/lswrIS87bRSq9reEJr3A+VQmppuH1rrndbxnMfSTGO7U9OtAPMxAmQpHRoLCNoNJApdNxDJYLo263zjOYW6HsakvKK7rzB4s99px/6M8LJibqLG5GMAqiKbWeokqTXN5PTznzZVwnbleVjIpcE0SKTTMQrMKhI+9tK8eoKS5VnaJeR3zXOGGSotxvp1aJjOlxsd9Vn059olGczcET4iPBkF9QW9Vg945BMTJWu5HqoWNXubcrU12ts8c3TunjpEhg44m/B6DQ5+Psc/yw34OBV+MfrtgMrMPLA+4q8+vr5W/nH7gEySqCnrIYUNV2fUBqBH9xuMpraeSOHQR3xfny0nJom6ywbjSY98M8w==&amp;v=404
</code></pre>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/45584f1978dca8c2a30c3b02e87ff092.jpg" alt="enter image description here" /></p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/d6c7d8e10acd5514ab2fda563f8daef4.jpg" alt="enter image description here" /></p>

<p><strong>小编说</strong>：我只是想安静地购个物，为何处处是危险？告诉你，钓鱼网站做得足够逼真的话，我真的会信的！</p>

<p><strong>WooYun-2015-132255</strong></p>

<p><strong><a href="http://www.wooyun.org/bugs/wooyun-2015-0132255">聚美优品安卓客户端组件暴露可实现钓鱼</a></strong></p>

<p>聚美优品安卓客户端版本3由于组件暴露问题，第三方应用可以启动应用，还可以打开钓鱼网站。</p>

<p>白帽子打开了一个支付宝登陆界面的利用代码，通过该代码可以从聚美优品的安卓客户端跳至支付宝登陆界面。</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/05fb2d94476181790e3f85858553459a.jpg" width = "300" height = "533" alt="图片名称" align=center /></p>

<p>假设黑客在利用代码中使用的网址是钓鱼网站的网址，并且因为还可以执行<code>JavaScript</code>代码，后果不堪设想。</p>

<p><strong>小编说</strong>：由于手机浏览器打开网页时，有时网址不可见，所以造成了钓鱼网站让人防不胜防的现象。聚美优品的用户群体主要是女性群体，这样的钓鱼网站让妹子的帐号等敏感信息随时处在危险当中。厂商不论在开发还是后来的安全架构中，都应小心谨慎，做到不该疏忽的不疏忽，不该暴露的不暴露。</p>

<h3>毫无防备的攻击</h3>

<p><strong>WooYun-2015-89779</strong></p>

<p><strong><a href="http://www.wooyun.org/bugs/wooyun-2015-089779">淘宝主要功能存储型XSS</a></strong></p>

<p>白帽子自己注册了一个淘宝网店，在发布宝贝时，标题和描述都可以插入XSS跨站脚本攻击代码。</p>

<p>以下是白帽子的测试过程。</p>

<p>测试代码：</p>

<pre><code>"&gt;&lt;img/src=1 onerror =alert (document.cookie)// "&gt;
</code></pre>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/829fec5967c1a6db79e267528cd0b3a3.jpg" width = "300" height = "533" alt="图片名称" align=center /></p>

<p>就这样弹了<code>cookie</code>，证明此处的确存在<code>XSS</code>跨站脚本攻击漏洞。</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/79537c6050578521e16d6c43d5670c29.jpg" width = "300" height = "533" alt="图片名称" align=center /></p>

<p>如果放一个吸引人的宝贝，访问量应该不会少吧？</p>

<p><strong>小编说</strong>：如果淘宝店主是个黑客，那你的网购行为还万无一失吗？此处白帽子的测试并未深入，作为安全从业人员应该知道，如果XSS代码构造得好，那黑客是可以达到自己的各种目的的。何况漏洞是在宝贝的标题和描述这样主要功能处，攻击来的这么突然让人怎么躲得开呢？淘宝作为一个用户群庞大、店铺众多的电商平台，这样的漏洞真的是不该出现的失误。</p>

<p><strong>WooYun-2015-90060</strong></p>

<p><strong><a href="http://www.wooyun.org/bugs/wooyun-2015-090060">京东某分站XSS漏洞修复不当仍然可以执行代码截获cookie</a></strong></p>

<p>这个漏洞其实已经是第二次被白帽子提交乌云了，在<a href="http://www.wooyun.org/bugs/wooyun-2014-088822">第一次提交</a>时，厂商修复并不彻底，导致了这个“二次伤害”。</p>

<p>测试XSS跨站漏洞不可少的弹弹弹：</p>

<pre><code>http://car.m.jd.com/jdshop.html?catId=123456;alert(document.cookie)
</code></pre>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/c28280b4429ca496fe3a6bcc6a07eaa4.jpg" alt="enter image description here" /></p>

<p>如果京东开发人员认为只能自己弹自己，过滤了<code>&lt;&gt;'"</code>这些就万事大吉那就错了。</p>

<p>来个直接远程获得<code>cookie</code>的。</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/dda134c20fe61b53a31ee24276b872cf.jpg" alt="enter image description here" /></p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/1919bebc4addc17b3ffc861b22a3d44a.jpg" alt="enter image description here" /></p>

<p><strong>小编说</strong>：漏洞修复的本来宗旨是为了杜绝下一次危害的发生，然而在这样一个大网站，漏洞修复不彻底的现象是否应该发生？我想厂商心中应该有自己的答案。</p>

<p><strong>WooYun-2015-114998</strong></p>

<p><strong><a href="http://www.wooyun.org/bugs/wooyun-2015-0114998">蘑菇街CSRF漏洞存在重置任意用户密码风险</a></strong></p>

<p>在用户快速登录的时候，会提示用户设置密码，如果没有检查这个接口而重复提交，就会出现重置密码或者邮箱的漏洞。</p>

<p>测试过程如下：</p>

<ul>
<li>1.用第三方帐号，快速登录到这个页面</li>
</ul>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/cc59c1e85930d7f225e4d8f6013b3698.jpg" alt="enter image description here" /></p>

<ul>
<li><p>2.设置密码，抓取请求包，这里什么防备都没有,然后弄成一个表单</p></li>
<li><p>3.其中<code>register_password</code>和<code>register_respassword</code>代表设置的密码和重复设置的密码</p></li>
<li><p>4.测试的效果的如下(这个接口设置密码，对已经设置密码的正常的用户也有效):</ul></p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/071c25f65baaf7d6462fce1adaaf1053.jpg" alt="enter image description here" /></p>

<p>这个漏洞的具体利用方式也可以脑补一下,就是在和店家交谈的过程中，给他连接让他访问。</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/c2e01e41b82becdbd9be14b4f028fb36.jpg" alt="enter image description here" /></p>

<p><strong>小编说</strong>：这样的漏洞让人如何防备呢？点个链接密码就被别人重置了，用户表示很惶恐。针对该漏洞，厂商应该检查接口的重复提交或者加上token之类的验证就可以避免，而对于CSRF的漏洞，最好的办法就是做好token之类的验证。</p>

<h3>简单漏洞危害大</h3>

<p><strong>WooYun-2015-143174</strong></p>

<p><strong><a href="http://www.wooyun.org/bugs/wooyun-2015-0143174">蘑菇街部分用户密码泄露</a></strong></p>

<p>这是一个仅仅依靠搜索引擎就可以实现的漏洞，真的让人表示很忧伤。</p>

<p>使用baidu和360好搜，搜索如下的关键词</p>

<pre><code>*****gt; string(32*****
</code></pre>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/919ae71e7fc858d8277071d5247b5e33.jpg" alt="enter image description here" /></p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/04ba0ca57fdf585e39d36ba92ce28be0.jpg" alt="enter image description here" /></p>

<p>密码是<code>md5加密</code>，去到<code>cmd5解密</code>，白帽子随机破了几个尝试登录，效果如下：</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/50f928ffa6ae367af908f9a1784c1441.jpg" alt="enter image description here" /></p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/a2c6928e5131835763d27998c70a1420.jpg" alt="enter image description here" /></p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/65b7a45110a035793db78c8676370cab.jpg" alt="enter image description here" /></p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/0bad6a54f778ffb3e8b5d663ea2743ce.jpg" alt="enter image description here" /></p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/f03dcb5e22ea7deece7961e08138c53c.jpg" alt="enter image description here" /></p>

<p><strong>小编说</strong>：作为一个同样爱网购的妹子，表示蘑菇街对于我的吸引力还是很大的，但是，这样可以简单实现的漏洞着实让我惶恐，然而在漏洞详情的最后，白帽子也没有理清楚这样的漏洞是为何出现，厂商是不是应该有一个全面排查呢？安全更应该揪根究底，发现问题不是最重要的，发现问题出现的原因才是最重要的。</p>

<p><strong>WooYun-2015-139742</strong></p>

<p><strong><a href="http://www.wooyun.org/bugs/wooyun-2015-0139742">美丽说存在SQL注入导致百万用户信息泄露</a></strong></p>

<p>美丽说某处存在<code>SQL注入漏洞</code>，可以使黑客通过工具得到数百万用户信息。</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/925da72fb14ee707d9d9fce36c75259d.jpg" alt="enter image description here" /></p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/2197880e143b6c8d6c707ccf848604e8.jpg" alt="enter image description here" /></p>

<p><strong>小编说</strong>：SQL注入漏洞是属于比较常出现的漏洞，由于利用工具已经成熟，所以利用手法较简单，但这样的漏洞往往危害极大，动辄可以使黑客得到数据库中的大量重要数据。对于这样经常出现、耳熟能详的漏洞，需要厂商的细心排查检测，避免出现这样危害极大的漏洞。</p>

<h3>那些羞羞的事</h3>

<p>上面提到了很多主流的电商购物网站，而其实还有一些较为冷门的购物网站，虽然用户群不如主流网购网站大，但是包含的信息却更为敏感，接下来提那么几个“羞羞的漏洞”。</p>

<p><strong>WooYun-2015-123581</strong></p>

<p><strong><a href="http://www.wooyun.org/bugs/wooyun-2015-0123581">桔色成人某处订单信息泄露（你买了啥我知道）</a></strong></p>

<p>在这个开放的时代，成人用品已经可以被做成电商平台，而桔色成人就是这样一个专注于成人用品的平台。</p>

<p>在桔色成人随便提交个订单，找到保存订单的URL。</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/b3af849251e9d9363356c4d0c721c47a.jpg" alt="enter image description here" /></p>

<pre><code>http://shop1.x.com.cn/save_orders.php?id_code=XA150629215367
</code></pre>

<p>可保存为本地txt，<code>id_code=XA150629215367</code>即为订单号。</p>

<pre><code>XA150629215367
</code></pre>

<p>第一位X，第二位A男士或M女士，下面是15年06月29日21时53分+两位随机数。</p>

<p>脚本可跑，不过会有一大部分空白，但订单信息真实可拿。</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/220d049ed2cd2a677faa27f640f90046.jpg" alt="enter image description here" /></p>

<p><strong>小编说</strong>：听说购买成人用品时包裹上会写得很隐秘，用户只想偷偷买一个成人用品，却就这样在互联网上被翻了出来。成人用品交易平台在用户信息上是不是应该做得更完善？毕竟大家都是含蓄的中国人。</p>

<p><strong>WooYun-2015-124423</strong></p>

<p><strong><a href="http://www.wooyun.org/bugs/wooyun-2015-0124423">都市丽人官方商城可查看别人订单详情（手机,收货地址）</a></strong></p>

<p>这是一个简单粗暴越权，可以看到整个订单，包括妹子的内衣大小。</p>

<p>在订单提交页面中抓取到的请求包里包含以下参数：</p>

<pre><code>orderId=900740537&amp;storeId=10001&amp;catalogId=10001&amp;langId=-7
</code></pre>

<p>通过修改<code>orderId</code>=，就可以看到妹子的订单了。</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/cf3661d66d0898e01899164312ab2322.jpg" alt="enter image description here" /></p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/bfb982a76630c34474304214c80454f4.jpg" alt="enter image description here" /></p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/16bd5bd11685ebe288fed11839a190b1.jpg" alt="enter image description here" /></p>

<p><strong>小编说</strong>：妹子对不起，就这样看到了你的大小！对于参数的控制不严造成的用户隐私泄漏，只能说明厂商在安全上所做的工作还不够全面。这样私密的商品，以后还有没有人敢在网上购买了呢？</p>

<p>另外，阿里巴巴作为一家业务分支庞大、业务网络复杂的公司，其旗下的天猫、淘宝等涉及的合作也较为复杂，安全是一个整体，在做好自身网络安全的同时，也要对内部员工以及第三方合作伙伴进行相应管束，不然一不小心就会成为背锅对象，危害到自家用户。</p>

<h3>背锅案例</h3>

<p><strong>WooYun-2015-134969</strong></p>

<p><strong><a href="http://www.wooyun.org/bugs/wooyun-2010-0134969">某大型商贸公司SQL注入（涉及天猫C店铺5W订单/泄露大量代理商信息/泄露大量买家信息）</a></strong></p>

<p>白帽子在一个POS店铺管理系统重置密码处发现注入漏洞，分析内容之后，发现通过该注入漏洞可以查看天猫C店各种数据，比如订单、评价、买家信息、电话、地址等。</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/33ddc0aacbb0ab7964eca4c71d005df8.jpg" alt="enter image description here" /></p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/c2c5509810e74e6619630107d984ac64.jpg" alt="enter image description here" /></p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/7566a2c470afff4ccdc7cbcccf173fd2.jpg" alt="enter image description here" /></p>

<p><strong>小编说</strong>：这个漏洞本身并不是天猫的锅，然而由于第三方的疏忽，使得天猫用户的敏感信息泄漏。由此也是可以看出电商安全难做，需要兼顾的方面太多。安全作为一个整体，严格遵循着木桶原理，哪怕任意一处的疏漏都有可能造成未知的危害。</p>

<p>最后，关于淘宝，小编从某渠道获悉已有部分用户数据流出，经验证为真实数据，而流出的原因在这里不做猜测，下面只看图不说话。</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/16ab2788d6454d15f874910e515ea109.jpg" alt="enter image description here" /></p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/775209bab180184af07579e67fe76d99.jpg" alt="enter image description here" /></p>

<h3>漏洞预警</h3>

<p>电商平台上用户信息的泄漏不仅在危害着不懂网络安全的普通人，哪怕是懂得安全技术的白帽子也在深受其害。</p>

<p><strong>WooYun-2015-150948</strong></p>

<p><strong><a href="http://www.wooyun.org/bugs/wooyun-2015-0150948">从不堪电话诈骗骚扰终于挖出苏宁用户信息泄露漏洞（白帽子亲身经历）</a></strong></p>

<p>白帽子自从9月17日在苏宁实体店购买了大电器之后就接到了几个<code>+4008365365</code>诈骗电话，到漏洞发出为止已接到三拨骗子的诈骗电话。在白帽子不堪忍受诈骗电话的骚扰后，挖出了苏宁信息泄露漏洞！据说是一个很容易就可以实现的漏洞，由于漏洞尚未公开，所以本期报告只做预警处理。</p>

<h1>Chapter Three 写在最后的话</h1>

<hr />

<p>列举了这么多的案例，相信大家已经感受到了网购中存在的安全问题以及面临的安全挑战。</p>

<p>以上列举的都是2015年里影响较大的漏洞，而在乌云知识库中，已经有白帽子为厂商总结了一些大的问题，原文为<a href="http://drops.wooyun.org/papers/741">电商网站的安全性</a>。</p>

<p>电子商务在互联网+时代的影响下，已经成为不可避免的主流趋势，未来的用户数量只会更多，这样庞大的用户群体不仅给商家带来了可观的利润，同时也成为了黑色产业的目标，在利益的驱使下，用户信息的买卖已经明目张胆。在这样的安全挑战之下，需要的不仅是电商企业对自身安全的完善，更需要第三方合作伙伴以及用户安全意识的提高。</p>

<p>那么，电商网站的安全究竟该如何完善呢？</p>

<p>从已经出现的漏洞案例来看，电商网站需要先明确要保护的重要数据有哪些。在小编看来，电商平台吸附着海量用户，上面存储着庞大的用户信息，在黑色产业暗涌的今天，这些信息应该被更加完善地保存。电商在做好互联网相关安全架构的同时，更应对其内部员工进行安全意识培训和行为约束，另外安全不仅仅是技术方面的提升和内部人员的管理，对于业务网络庞大复杂的厂商，健全第三方合作伙伴管理制度也非常重要，提高第三方合作伙伴的安全意识，做到安全管理无处不在，全方位保障用户利益。</p>

<p>明天就是一年一度的双十一了，希望大家在畅爽购物的同时，也注意保管好自己的信息安全，不要轻易点击可疑链接，也不要轻信来路不明的电话喔。</p></li>
</ul>

<h1>Chapter Four 贡献者</h1>

<hr />

<p>感谢以下的小伙伴对本次乌云爆告的帮助，爆告中的部分案例为白帽子匿名提交，所以未出现在下表。</p>

<p>再次感谢所有白帽子为了网络安全做出的努力与贡献！</p>

<table border="1">
  <tr>
    <td>
      艺灵设计
    </td>
    
    <td>
      乌云白帽子（漏洞案例作者）
    </td>
  </tr>
  
  <tr>
    <td>
      鸟云厂商
    </td>
    
    <td>
      乌云白帽子（漏洞案例作者）
    </td>
  </tr>
  
  <tr>
    <td>
      hh88
    </td>
    
    <td>
      乌云白帽子（漏洞案例作者）
    </td>
  </tr>
  
  <tr>
    <td>
      谜一样的
    </td>
    
    <td>
      乌云白帽子（漏洞案例作者）
    </td>
  </tr>
  
  <tr>
    <td>
      q601333824
    </td>
    
    <td>
      乌云白帽子（漏洞案例作者）
    </td>
  </tr>
  
  <tr>
    <td>
      pandas
    </td>
    
    <td>
      乌云白帽子（漏洞案例作者）
    </td>
  </tr>
  
  <tr>
    <td>
      zj1244
    </td>
    
    <td>
      乌云白帽子（漏洞案例作者）
    </td>
  </tr>
  
  <tr>
    <td>
      碎片
    </td>
    
    <td>
      乌云白帽子（漏洞案例作者）
    </td>
  </tr>
  
  <tr>
    <td>
      瞌睡龙
    </td>
    
    <td>
      乌云白帽子（《电商网站的安全性总结》作者）
    </td>
  </tr></tr> 
  
  <tr>
    <td>
      wudi
    </td>
    
    <td>
      乌云白帽子
    </td>
  </tr></tr> 
  
  <tr>
    <td>
      疯狗
    </td>
    
    <td>
      乌云白帽子
    </td>
  </tr>
  
  <tr>
    <td>
      皂皂
    </td>
    
    <td>
      乌云爆告设计者
    </td>
  </tr>
</table>

<p>P.S：欢迎各位对第二期乌云爆告提出自己的见解和建议，您可以通过邮箱联系我们，我们的邮箱地址是<a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="eb868e8f828aab9c8484929e85c584998c">[email&#160;protected]</a><script data-cfhash='f9e31' type="text/javascript">
/* <![CDATA[ */!function(){try{var t="currentScript"in document?document.currentScript:function(){for(var t=document.getElementsByTagName("script"),e=t.length;e--;)if(t[e].getAttribute("data-cfhash"))return t[e]}();if(t&&t.previousSibling){var e,r,n,i,c=t.previousSibling,a=c.getAttribute("data-cfemail");if(a){for(e="",r=parseInt(a.substr(0,2),16),n=2;a.length-n;n+=2)i=parseInt(a.substr(n,2),16)^r,e+=String.fromCharCode(i);e=document.createTextNode(e),c.parentNode.replaceChild(e,c)}t.parentNode.removeChild(t);}}catch(u){}}()/* ]]> */</script></p>      </p>
    
</body>
</html>