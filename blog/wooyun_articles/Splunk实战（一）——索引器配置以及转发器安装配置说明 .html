
        <html>
			<head>
			     <title>Splunk实战（一）——索引器配置以及转发器安装配置说明  - RipZ</title>
				 <meta http-equiv="content-type" content="text/html; charset=UTF-8">
			</head>
			<body>
				<h1>原文地址:<a href="http://drops.wooyun.org/tips/16143">http://drops.wooyun.org/tips/16143</a></h1>
				
      <p>
        <h1>0x00 前言</h1>

<hr />

<p>本文将以连载的形式分享splunk在实战中的运用：从索引器&amp;转发器的安装部署开始，到普通搜索&amp;字段提取，再到报表&amp;仪表盘定制以及告警等，详细的写出作者在实战中的经验（其实是遇到的坑），让大家看完之后可以少走些弯路。</p>

<h1>0x01 Splunk简述</h1>

<h2>什么是Splunk？</h2>

<p>Splunk是机器数据的引擎。使用 Splunk 可收集、索引和利用所有应用程序、服务器和设备（物理、虚拟和云中）生成的快速移动型计算机数据，随时从一个位置搜索并分析所有实时和历史数据。使用 Splunk可以在几分钟内（而不是几个小时或几天）解决问题和调查安全事件，关联并分析跨越多个系统的复杂事件，从而获取新层次的安全运营以及业务运营可见性。</p>

<!--more-->

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/01f4cfda943fd55cdea21f76773e85ce.jpg" alt="" /></p>

<h2>Splunk的强大之处</h2>

<p>Splunk 可以从任何源实时索引任何类型的计算机数据，由下图可见，通过端口监听来收集各类服务器或者网络设备的日志，还可以通过脚本来获取系统指标等。</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/b98d19404d5039095b3e0d246d57565b.jpg" alt="" /></p>

<p>同时，可以通过在各个操作系统安装部署转发器（forwarder），来实现将各个agent端日志目录文件发送到splunk索引器（indexer）中。下图最底层为forwarder，中间层为indexer。</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/5ccec80972bede08b37687b735f9966f.jpg" alt="" /></p>

<p>简要介绍了一下整体架构，下面我们进入实战环节。</p>

<h1>0x02 环境准备</h1>

<hr />

<h2>Splunk索引器</h2>

<p>6.3.3版本，IP为10.2.1.157</p>

<h2>Splunk转发器</h2>

<p>Linux&amp;windows的6.3.3版本</p>

<h1>0x03 索引器配置</h1>

<p>索引器端需要配置监听端口，以便接收从转发器端发来的日志文件等。在“设置——转发和接收——接收数据”中配置监听9997端口</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/deaac549479a0970e349f153793c6a5f.jpg" alt="" /></p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/f7a01e82d5a3aefc76cf55b20fc12569.jpg" alt="" /></p>

<p>另外索引器默认的管理端口是8089，无需配置。</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/33494d5747e3d36bff5d10fba404424d.jpg" alt="" /></p>

<h1>0x04 Windows转发器配置</h1>

<hr />

<h2>准备工作</h2>

<ol>
<li>splunk转发器下载地址</li>
</ol>

<p>https://www.splunk.com/page/previous_releases/universalforwarder</p>

<ol>
<li><p>需要在windows server上将”本地安全策略——本地策略——审核策略”中的所有审核策略均配置为”成功“和失败”</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/c7938ee864aee03779a068dc6ad7b55d.jpg" alt="" /></p></li>
</ol>

<h2>安装过程</h2>

<p>首先复制转发器到相应的服务器上</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/fdef9a26c3223d56743766dedc42c2ba.jpg" alt="" /></p>

<p>双击执行该文件，如下图所示，勾选接受协议，之后选择“Customize Options”即自定义安装</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/6e65886bdb41d3c551f51bf52765faa9.jpg" alt="" /></p>

<p>路径默认即可</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/6d52127e8e23822aa1428c2695799572.jpg" alt="" /></p>

<p>勾选上“windows Event Logs”以及“Performance Monitor”的全部选项，但不用勾选”AD monitoring”（否则如果在域环境下，索引器会收到大量域内无用消息，极为占用资源），如下图。</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/77546a881b15a9ecb266e23fe17598b5.jpg" alt="" /></p>

<p>这个步骤默认即可。</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/496ba57c916d54c78ea0c4f483f0e164.jpg" alt="" /></p>

<p><font color="red">（重要！）</font>配置调度服务器（这一步是为了让indexer可以识别到forwarder，并且可以从管理端下发日志采集指令）。 这一步中的IP填写为10.2.1.157，端口填写为8089，如下图。</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/4496e85d38ab8220662a6cfe2ca79779.jpg" alt="" /></p>

<p><font color="red">（重要！）</font>这一步中配置接收索引器（这一步是为了让indexer可以接收到forwarder发来的日志），IP填写为10.2.1.157，端口填写为9997。</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/b199a45b0c3e3a21cd63d5706014614d.jpg" alt="" /></p>

<p>执行安装过程完毕后，点击Finish结束。</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/bbaa0b473ef6834609571251b52e636a.jpg" alt="" /></p>

<p>最后在索引器中可以看到该转发器已连接上</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/b2da3103a22b4e2e7ee3537b9b955bd0.jpg" alt="" /></p>

<h1>0x05 Linux转发器配置</h1>

<hr />

<h2>安装过程</h2>

<p>首先查看当前IP。</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/4747396e768accfb62667a37e1ce5d89.jpg" alt="" /></p>

<p>从内网服务器下载压缩包：</p>

<pre><code>#!shell
wget http://10.2.24.66/splunkforwarder-Linux.tgz
</code></pre>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/1547acb5434ca489728b9134fc6cb61f.jpg" alt="" /></p>

<p>解压。</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/bc8f173a113745f3b23542070a2abc1b.jpg" alt="" /></p>

<p>进入<code>%splunkforwarder%/bin</code></p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/4caf578342f64dc536e1219ef1811dff.jpg" alt="" /></p>

<p>输入<code>./splunk start</code>进行安装</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/5d3723d0c25a8494ed8c1d55e5c818d2.jpg" alt="" /></p>

<p>输入y，等待安装完成。</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/35ac9809f3547490bdb1184e2e3b733b.jpg" alt="" /></p>

<p>输入<code>./splunk enable boot-start</code>，配置为开机启动</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/b23a8e24bcdda7822ae0ac3cb9d3f993.jpg" alt="" /></p>

<p><font color="red">（重要！）</font>配置调度服务器（这一步是为了让indexer可以识别到forwarder，并且可以从管理端下发日志采集指令）。</p>

<p>遇到的坑：<font color="red">6.3.3的转发器安装貌似没法通过输入命令来指定对端索引器，如果不搞配置文件的话，索引器是无法感知到这个转发器的。</font></p>

<p>随后在<code>%splunkforwarder%/etc/system/local/</code>配置deploymentclient.conf</p>

<p>其文件内容格式为：</p>

<pre><code>[target-broker:deploymentServer]
targetUri = 10.2.1.157:8089
</code></pre>

<p>如下配置即为成功</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/ea16a1f14bc91e9e875576d197e75c57.jpg" alt="" /></p>

<p><font color="red">（重要！）</font>这一步中配置接收索引器（这一步是为了让indexer可以接收到forwarder发来的日志）</p>

<p>另外需要在<code>%splunkforwarder%/etc/system/local/</code>配置outputs.conf</p>

<pre><code>[tcpout]
defaultGroup = defau；lt-autolb-group    

[tcpout:default-autolb-group]
server = 10.2.1.157:9997    

[tcpout-server://10.2.1.157:9997]
</code></pre>

<p>如下配置即为成功</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/4e966da76f6ffdc830eb9e315f4ce112.jpg" alt="" /></p>

<p>配置完conf文件后需要重启splunk服务</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/04a1bd8a9f7770c32ee5a2099e25e0b0.jpg" alt="" /></p>

<p>另外，还需要配置<code>/etc/rsyslog.conf</code>，设置接收syslog条目为：（为了实现索引分类，这里我将linux的syslog指定发到索引器的516端口）</p>

<p><code>* @10.2.1.157:516</code></p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/85f7cbc454d8d27cb49e2697e163e080.jpg" alt="" /></p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/017158ad8e29d2bda0298e030e0f2aef.jpg" alt="" /></p>

<p>配置完毕后保存退出，并且重启rsyslog服务。</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/1577009df910b9b4a53e78c0e18a8ec4.jpg" alt="" /></p>

<p>至此，linux端转发器配置完毕。</p>

<p>随后可看到在server端服务器列表中，该转发器已连接上。</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/da3f9b5b653577c8ae48e8b9775cabb0.jpg" alt="" /></p>

<h1>0x06 添加转发器中的数据</h1>

<hr />

<p>首先选择“设置——数据导入“</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/b3eed6f9ec43064aa1129204c48da032.jpg" alt="" /></p>

<p>选择添加来自于转发器的数据——windows事件日志</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/46126eb826cf2941275b720274ce9be9.jpg" alt="" /></p>

<p>新建一个服务器组</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/6fffb6e29905489dea73caca3b37baf9.jpg" alt="" /></p>

<p>由于目前只关心安全日志，只选security即可，如下图。</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/43758b41d8fbc6be0b0db299861bf62e.jpg" alt="" /></p>

<p>将这些转发器的上述配置好的日志均发送到自己新建的windows索引中，以免在超大的main索引里查询导致效率下降。</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/927a8f19a54cfcc15b8ec56f8c0c482b.jpg" alt="" /></p>

<p>同理，在”添加数据——文件和目录”功能中，可以直接导入转发器的IIS或tomcat等日志目录所在的路径，配置完毕后由转发器自动将日志发到索引器上来（好像远控有木有）</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/288b50be09005884bf2886919487704f.jpg" alt="" /></p>

<p>再将不同类别的日志存放到相应的索引中即可。</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/3a3f38497d7d33675df63b0f5621e6c3.jpg" alt="" /></p>

<p>最后在搜索时输入index=windows或者index=iis，即可搜到所有转发器发来的日志了。</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/3a9a92514b6a2ff60d0f39a779b4bd76.jpg" alt="" /></p>

<p>另外，在上一章节中所配置的linux syslog已经发送到了516端口，所以在这里我们新建一个监听UDP:516的规则</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/9ce7a3bce2c5f9bd7fb4c4b41d078f0e.jpg" alt="" /></p>

<p>并建立一个单独的linux索引来存储发到516端口的UDP数据（即syslog），届时直接搜索index=linux即可。</p>

<h1>0x07 简单的报表示例</h1>

<hr />

<h2>统计暴力破解SSH的源IP</h2>

<p>先通过linux登录失败的特征字段“failed password”来查询，同时，linux的日志均在名为linux的索引表中，故应该搜索：index=linux failed password。如下图</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/74393b7fc2f1f4fbbc66526c8679e8d2.jpg" alt="" /></p>

<p>之后想要统计来源的IP都有哪些，此时点击左侧的“Src_ip”，选择”上限值”，即为发生次数最多的前20个。</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/2787fe4dd066b9195767861912f7681f.jpg" alt="" /></p>

<p>可以自动生成统计图，直观展示哪些源IP的次数最多。</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/2aefb2f189677af1878c46941989095d.jpg" alt="" /></p>

<p>之后将Src&#95;ip改为Dst&#95;ip，可以观察哪些linux服务器正遭受暴力破解的威胁。</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/41b08f8cc84a0ea29269408f30078f48.jpg" alt="" /></p>

<p>至于上面说的Src&#95;ip和Dst&#95;ip是怎么分割出来的，且听下回分解《搜索技巧&amp;字段提取》。</p>      </p>
    
			</body>
		</html>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          