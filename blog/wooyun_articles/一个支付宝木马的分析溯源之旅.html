
        <html>
			<head>
			     <title>一个支付宝木马的分析溯源之旅 - 360安全卫士</title>
				 <meta http-equiv="content-type" content="text/html; charset=UTF-8">
			</head>
			<body>
				<h1>原文地址:<a href="http://drops.wooyun.org/papers/14103">http://drops.wooyun.org/papers/14103</a></h1>
				
      <p>
        <p><strong>Author: 360天眼实验室</strong></p>

<h1>0x00 引子</h1>

<hr />

<p>人在做，天在看。</p>

<p>与网络的黑暗面斗争中，我们看到太多的年轻人陷入黑产的陷井，少数人暴发横财及时收手还能全身而退，多数人身处产业链的底端所得不多却受牢狱之灾。年轻人是国家的未来，他们敢想敢干而又无知鲁莽，希望他们不要为一时的无知付出太大的代价，今天的这个文章可以算作一个警醒，千金不换回头路。</p>

<p>网络从来就是一把双刃剑，越来越便捷的知识传播让广大的网络黑产工作者们只需简单修改别人的代码就可以制作出所谓的原创木马病毒，并进一步出售进行获利。近期，360天眼实验室拦截到一类盗取用户支付宝余额的木马，追根溯源揪出了木马制造者及一批木马放马者，而背后的造马者竟是一个高三学生，我们想说考不考得上大学还在其次，这位同学现在最应该读一下网络犯罪相关法条立即收手以免终身受此所累。</p>

<!--more-->

<h1>0x01 样本分析</h1>

<hr />

<p>为了对抗查杀，使用易语言做木马开发极其常见，我们所看到的这个样本即是如此，相关的信息如下，供大家参考。</p>

<p>木马文件MD5: 1976f6cbbc32fcbd7eaa75318642a182</p>

<p>尽管分析起来有点麻烦，但搞清楚木马行为只是时间问题，主要包括：</p>

<ul>
<li>代码加入花指令，对抗分析调试</li>
<li>过期自动失效（失效后想再次使用木马就要向木马作者缴费再次购买）</li>
<li>访问腾讯微博、新浪微博链接地址获取支付宝交易的钱数、次数、频率</li>
<li>开线程监控用户的支付宝转账操作，同时将转账地址替换成放马者指定的支付宝账户</li>
</ul>

<h3>加入花指令，对抗分析调试</h3>

<p>部分花指令如下：</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/9c6f31ea52a5868879f3641a5b254ef3.jpg" alt="" /></p>

<h3>判断木马是否过期</h3>

<p>过期时间是2016年1月14日，如图：</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/53bf2fef002a79d7daf47900e507f53e.jpg" alt="p2" /></p>

<h3>访问微博链接获取交易欺诈参数</h3>

<p>访问<code>http://t.qq.com/q912xxx937</code>微博地址，匹配出木马所需的信息，微博内容为：</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/1a0331a01b4292f07cfefe4b57a53a8d.jpg" alt="p3" /></p>

<p>解密出微博地址：</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/cbe765b84a50f2a74c484590e070cfe4.jpg" alt="p4" /></p>

<p>访问腾讯微博地址，得到微博内容：</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/51027624139ac9d7684f4ef969a7b5bf.jpg" alt="p5" /></p>

<p>从微博页面中匹配“支付宝读取头部”和“支付宝读取尾部”，匹配出木马预留信息：</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/5b3f5c3c1aee068e60f8e8dd538f6667.jpg" alt="p6" /></p>

<p>获取到页面数据后，通过作者预先写好的开始标记和结束标记读取到用到的数据：</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/b20541ca2bc49c37fb779ab50f4b5ff4.jpg" alt="p7" /></p>

<p>从微博读取到的支付宝所需数据格式为"13267932191|1100|80|1100"，其中的13267932191表示支付宝账号，1100表示快捷金额，80表示触发金额，1100 是最大限额。当然，如果腾讯微博格式发布信息格式不正确，木马还会弹窗报错，提示发布正确格式的微博内容。</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/ce958c4070cb6e9097acd1863b9c9722.jpg" alt="p8" /></p>

<p>对于木马转账的支付宝账号：13267932191，推测应该是一个手机号，从搜索引擎搜索结果得知，手机归属地是广州惠州的，如图：</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/d6fce8de2631975ed80d2adb0d24b7ac.jpg" alt="p8" /></p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/e807599d34d4cb1a4613d25b9c486087.jpg" alt="p9" /></p>

<h3>账号替换</h3>

<p>木马程序打开后起线程不停查找浏览器的窗口，直到浏览器的地址栏包含alipay字符后，木马开始对支付过程进行劫持：</p>

<p>调用易语言的类库，获取当前的URL地址，用于判断用户是否正在进行支付操作。</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/6135421efff55942e17885196489b920.jpg" alt="p10" /></p>

<p>如果用户正在进行支付操作，就查找<code>https://personalweb.alipay.com/portal/newhome.htm</code>网址中的<code>&lt;span class="integer"</code>标签和<code>&lt;input type="hidden" id="J-mfund-balance" value=</code>标签分别得到用户的账户余额和余额宝的余额。</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/f855032393ec3121aa71117a1fac6112.jpg" alt="p11" /></p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/2aaa957095bb2e045152ae42f6803908.jpg" alt="p12" /></p>

<p>在后台进行封包劫持：</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/c034ff040e76caa889d82a8f424075da.jpg" alt="p13" /></p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/59079d3206bba8f0d3d5d04b6a11529b.jpg" alt="p14" /></p>

<p>木马通过注入浏览器，后台Post提交参数的方式，用户从浏览器中看不出有任何的异常，而只有在支付之后的交易记录中，才有可能发现收款人已被替换。而一切都以为时晚矣。</p>

<h1>0x02 推手追索</h1>

<hr />

<p>通过搜索引擎搜索“支付宝读取头部”关键字，我们找到了一批有问题的腾讯微博账号，这些账号大多都是直接从木马作者手中购买木马的“放马者”：</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/3e9f988f636d9d760cf48c1dc7481569.jpg" alt="p15" /></p>

<p>然后，我们就从这批放马者的账号中发现一个亮瞎眼的账号内容</p>

<p><code>http://t.qq.com/hy617xxx31</code></p>

<p>至于亮瞎眼的原因见下图，由此，我们定位到了可疑造马者，QQ号为：5500xxx39和617xxx31 ：</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/1da97dd6eebfc6838029e88569db4c4b.jpg" alt="p16" /></p>

<p>下面我就将按照”造马者”与“放马者”两条线索分别展开。</p>

<h3>造马者追踪</h3>

<p>通过对造马者的发微博时的实时位置，定位到造马者经常在四川省南充市活动，如图：</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/3e97663dbe2f6207ce9cb268f918de74.jpg" alt="p17" /></p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/41d0fe94a28da6ddcb82dbbd32610fc1.jpg" alt="p18" /></p>

<p>另外，通过对上面两个QQ号公开的信息比较，也确定这两个QQ号都是造马者的QQ号，其中5500xxx39的QQ号为造马者的小号。</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/4efca4dd8a5483561e58d97856ef5568.jpg" alt="p19" /></p>

<p>而617xxx31为造马者联系木马业务的常用号码：</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/32b1e286e2ef04634501a25271e67310.jpg" alt="p20" /></p>

<p>从搜索引擎也得知，造马者曾被人举报，称造马者盗源码写软件：</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/5a23c796ebde073e541b120a3bf8c2f3.jpg" alt="p21" /></p>

<p>造马者为了销售木马，还专门成立了一个QQ群，推测群里应该有好多放马者，当然根据群位置信息，也可以进一步确定造马者所在的地理位置正是南充，与前面关于造马者地理的推断一致。</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/cc29a09e6204a2d4c7bc4a3dcea8e970.jpg" alt="p22" /></p>

<p>过对造马者QQ持续的关注，基本可以断定造马者是高中生。</p>

<p>2015年12月份，造马者QQ的修改签名为“秒余额，快捷，余额宝免杀马代秒鱼。回5。需要的私聊大量收家庭肉鸡，有的窗口。”，如下图</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/37b16f857a71881f266cce899dc869ce.jpg" alt="p23" /></p>

<p>而2016年2月29日，QQ个性签名更改为“3月份停工，高考后复出，学习新技能”，可以推断出造马者是高中生：</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/b8699c2a9aa2381deeaa2a70b1972553.jpg" alt="p24" /></p>

<p>与此同时，我们还在造马者的腾讯微博中看到造马者对木马书写的“产品说明书”（支持Windows所有版本）、“广告语”（高度人性化，可操作性强，稳定性强）、价格（支付宝收款700/月，银行卡收款1000/月）等，见下图：</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/db6a7b75037fb87aac4f13044f33d833.jpg" alt="p24" /></p>

<p>查询QQ群关系数据库，得到造马人的另外一个常用的QQ号码:963xxxx39：</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/9e860f9752914b5e0289abb894cf7bb7.jpg" alt="p25" /></p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/4cdb3c6f8b1e701a0ac9e62d8808678f.jpg" alt="p28" /></p>

<p>通过网上搜索QQ963xxxx39，发现造马者经常关注一些网络上的黑客教程，并且曾经从易语言论坛下载过支付宝支付账单源代码，如图：</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/c9eb6a83b6c4f97b17e0fbff102d6791.jpg" alt="p27" /></p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/29df2ebe54abf0eb1591b3406fd723dd.jpg" alt="p28" /></p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/668ca72db00ae0613ae910e13a9bb901.jpg" alt="p29" /></p>

<p>把易语言论坛上的这份“支付宝支付账单的源代码”下载后得知，代码的作用是查询支付宝交易记录，造马者在造马的过程中参考过这份源码。如图：</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/b061ded1eefb23ca77fdabe8602f64aa.jpg" alt="p30" /></p>

<p>索引擎查询造马者QQ号关键字找到了这个人的优酷账号，其上传的视频中表明造马者的另一个身份：dnf玩家。</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/ed7835e51e077f1895d6cda172f81e0c.jpg" alt="p31" /></p>

<p>同时搜索引擎告诉我们的还包括造马者的淘宝账号：a963xxxx39</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/e1160c0df7acd14d81aba97499951cc3.jpg" alt="p32" /></p>

<p>在此，我们推测这人的邮箱地址可能为：<code><a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="d0b1e9e6fafafafafae3e990e1e6e3feb3bfbd">[email&#160;protected]</a><script data-cfhash='f9e31' type="text/javascript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script></code></p>

<p>通过163找回密码，发现账号绑定的手机号码的后三位与淘宝账号中的手机的后三位是相同的，这就断定<code><a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="fa9bc3ccd0d0d0d0d0c9c3bacbccc9d4999597">[email&#160;protected]</a><script data-cfhash='f9e31' type="text/javascript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script></code>邮箱是属于造马者的，如图：</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/a344e7389de5dd2d31220b93969af21e.jpg" alt="p33" /></p>

<p>通过尝试，找到了造马者的163邮箱密码：96xxxxx39</p>

<p>在邮箱中的已发送邮件中，大量的cf木马发送的邮件，邮件内容里面都是木马盗取的cf账号和密码等游戏信息。</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/461463e0dea8c3199ef8d9145c1a027a.jpg" alt="p34" /></p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/2d2c67d5747358814fd54226f0cbeaa4.jpg" alt="p35" /></p>

<p>此外，观察到邮箱中有作者的MAC地址：00-50-56-c0-00-01，应该是造马者在测试程序时发送的，如图：</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/ab70f53a07a1810b20b635cebe94e481.jpg" alt="p36" /></p>

<p>总结：<br />
造马者经常活动于南充，可能的身份为：在校高中学生。机器mac地址可能为： 00-50-56-c0-00-01，作者不仅编写支付宝木马，还曾经盗取过cf游戏账号，常用邮箱为：<a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="3c5d050a444444440f057c0d0a0f125f5351">[email&#160;protected]</a><script data-cfhash='f9e31' type="text/javascript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script>，常用密码为：a96xxxxx39，常用的三个QQ号为617xxx31，5500xxx39，和963xxxx39，其中617xxx31号多用来卖支付宝木马；963xxxx39号多用来盗取游戏账号；5500xxx39为小号，不常使用。淘宝账号为：a963xxxxx39，手机号为：136xxxx5205</p>

<h3>放马者分析</h3>

<p>购买木马的人数众多，根据360威胁情报中心的数据，木马买家超过40人。我们随意抽取一个购买木马的用户进行探讨。</p>

<p>以下都是通过搜索引擎得到的放马者的微博地址：</p>

<ul>
<li>http://t.qq.com/g29q200w4231975</li>
<li>http://t.qq.com/r12tb9753197 </li>
<li>http://t.qq.com/oclt519753</li>
<li>http://t.qq.com/k93y642086</li>
<li>http://t.qq.com/chenjiaxi88</li>
</ul>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/e882d0429375a21e02cab5dc77c4983a.jpg" alt="p37" /></p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/8fb134296245b44238b94b31787660ef.jpg" alt="p38" /></p>

<p>对于其中一个放马者，<a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="947d140e7c2b13712a3a71190e711b05731a24d4f7fcf1fafefdf5ecfdacac730e1073003c721c23730e10710419713903702c2e7d0d1c7029277c312b">[email&#160;protected]</a><script data-cfhash='f9e31' type="text/javascript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script>，腾讯微博中有其上传的生活照，如下：</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/6b1e616c8950297cd01151d1968a1995.jpg" alt="p39" /></p>

<p>最后，用这位放马者的QQ群关系来结束这次的追踪之旅：</p>

<p><img src="https://github.com/ikey4u/WooyunImages/raw/master/pics/74fb741be6b8dd86f83271ef59da577c.jpg" alt="p40" /></p>

<h1>0x03 总结</h1>

<hr />

<p>我们看到的木马本身的技术并不复杂，传播手段也不见得高明，低技术门槛使网络犯罪的参与者呈现年轻化的分布。本次的攻击者溯源完全依赖公开可搜索的数据，甚至无需运用社工技巧，木马开发与使用者的无知无畏实在让人心惊。从造马者自发暴露的大量信息来看，他似乎并不觉得自己在违法犯罪，我们的中学教育在法律学习方面应该加入网络犯罪的内容。</p>      </p>
    
			</body>
		</html>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          